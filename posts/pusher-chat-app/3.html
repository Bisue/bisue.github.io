<!DOCTYPE html>
<html lang="ko-KR" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.61" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://bisue.github.io/posts/pusher-chat-app/3.html"><meta property="og:site_name" content="비수의 개발 창고"><meta property="og:title" content="Pusher 를 이용한 실시간 채팅 웹앱 만들기 #3 (w/ Laravel, Nuxt)"><meta property="og:description" content="Pusher 를 이용한 실시간 채팅 웹앱 만들기 #3 (w/ Laravel, Nuxt) 이번 글에서는 본격적으로 채팅 서비스를 위한 백엔드 코드들을 Laravel로 작성해보면서 Laravel에서 Pusher와 연동하여 이벤트를 클라이언트들로 브로드캐스팅 해보겠습니다. 가장 기본적인 기능 구현하기 컨트롤러 생성 일단 먼저 어떤 사용자가 다른 사용자에게 보낼 메세지를 작성하고, 엔터를 누르거나 '보내기' 버튼을 누르면 그 메세지가 우리의 서버를 거쳐서 채팅에 참여하는 다른 사용자들에게 보내져야 할 것입니다."><meta property="og:type" content="article"><meta property="og:image" content="/thumb.png"><meta property="og:locale" content="ko-KR"><meta property="og:updated_time" content="2023-02-28T13:56:09.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="Pusher 를 이용한 실시간 채팅 웹앱 만들기 #3 (w/ Laravel, Nuxt)"><meta property="article:tag" content="Pusher"><meta property="article:tag" content="Laravel"><meta property="article:tag" content="Nuxt"><meta property="article:tag" content="Vue"><meta property="article:tag" content="Web"><meta property="article:published_time" content="2021-07-12T00:00:00.000Z"><meta property="article:modified_time" content="2023-02-28T13:56:09.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Pusher 를 이용한 실시간 채팅 웹앱 만들기 #3 (w/ Laravel, Nuxt)","image":["/thumb.png"],"datePublished":"2021-07-12T00:00:00.000Z","dateModified":"2023-02-28T13:56:09.000Z","author":[]}</script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@200;300;400;500;600;700;900&display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic+Coding:wght@400;700&display=swap" rel="stylesheet"><title>Pusher 를 이용한 실시간 채팅 웹앱 만들기 #3 (w/ Laravel, Nuxt) | 비수의 개발 창고</title><meta name="description" content="Pusher 를 이용한 실시간 채팅 웹앱 만들기 #3 (w/ Laravel, Nuxt) 이번 글에서는 본격적으로 채팅 서비스를 위한 백엔드 코드들을 Laravel로 작성해보면서 Laravel에서 Pusher와 연동하여 이벤트를 클라이언트들로 브로드캐스팅 해보겠습니다. 가장 기본적인 기능 구현하기 컨트롤러 생성 일단 먼저 어떤 사용자가 다른 사용자에게 보낼 메세지를 작성하고, 엔터를 누르거나 '보내기' 버튼을 누르면 그 메세지가 우리의 서버를 거쳐서 채팅에 참여하는 다른 사용자들에게 보내져야 할 것입니다.">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-ed105fa0.css" as="style"><link rel="stylesheet" href="/assets/style-ed105fa0.css">
    <link rel="modulepreload" href="/assets/app-62184bd0.js"><link rel="modulepreload" href="/assets/framework-54cb4b8e.js"><link rel="modulepreload" href="/assets/3.html-89092d67.js"><link rel="modulepreload" href="/assets/3.html-bdc0cfea.js"><link rel="prefetch" href="/assets/index.html-0a5098b7.js" as="script"><link rel="prefetch" href="/assets/intro.html-3f86a88b.js" as="script"><link rel="prefetch" href="/assets/index.html-018cf9f7.js" as="script"><link rel="prefetch" href="/assets/index.html-64203cab.js" as="script"><link rel="prefetch" href="/assets/index.html-7f8b6d7a.js" as="script"><link rel="prefetch" href="/assets/1.html-f2c98862.js" as="script"><link rel="prefetch" href="/assets/2.html-91150111.js" as="script"><link rel="prefetch" href="/assets/4.html-344778da.js" as="script"><link rel="prefetch" href="/assets/5.html-128c6491.js" as="script"><link rel="prefetch" href="/assets/index.html-e3a9aafe.js" as="script"><link rel="prefetch" href="/assets/index.html-cd688c45.js" as="script"><link rel="prefetch" href="/assets/SSL-unsafe-legacy-renegotiation.html-903c4af4.js" as="script"><link rel="prefetch" href="/assets/index.html-4817f723.js" as="script"><link rel="prefetch" href="/assets/index.html-0b8cdc6e.js" as="script"><link rel="prefetch" href="/assets/index.html-f799dba9.js" as="script"><link rel="prefetch" href="/assets/404.html-8cc9b996.js" as="script"><link rel="prefetch" href="/assets/index.html-2bcb6d1d.js" as="script"><link rel="prefetch" href="/assets/index.html-4fcd0174.js" as="script"><link rel="prefetch" href="/assets/index.html-70608aec.js" as="script"><link rel="prefetch" href="/assets/index.html-2b51108b.js" as="script"><link rel="prefetch" href="/assets/index.html-9dc17548.js" as="script"><link rel="prefetch" href="/assets/index.html-b57f69e5.js" as="script"><link rel="prefetch" href="/assets/index.html-efd714ac.js" as="script"><link rel="prefetch" href="/assets/index.html-88d8ffb0.js" as="script"><link rel="prefetch" href="/assets/index.html-710d8c46.js" as="script"><link rel="prefetch" href="/assets/index.html-7a430159.js" as="script"><link rel="prefetch" href="/assets/index.html-c14e89de.js" as="script"><link rel="prefetch" href="/assets/index.html-9499e7e5.js" as="script"><link rel="prefetch" href="/assets/index.html-844cdf3c.js" as="script"><link rel="prefetch" href="/assets/index.html-15e12100.js" as="script"><link rel="prefetch" href="/assets/index.html-1538dd5c.js" as="script"><link rel="prefetch" href="/assets/index.html-5f7c4440.js" as="script"><link rel="prefetch" href="/assets/index.html-56498993.js" as="script"><link rel="prefetch" href="/assets/index.html-5be2895b.js" as="script"><link rel="prefetch" href="/assets/index.html-19cfa369.js" as="script"><link rel="prefetch" href="/assets/intro.html-310e3195.js" as="script"><link rel="prefetch" href="/assets/index.html-e6f87fb7.js" as="script"><link rel="prefetch" href="/assets/index.html-7b34869d.js" as="script"><link rel="prefetch" href="/assets/index.html-0f97f4dd.js" as="script"><link rel="prefetch" href="/assets/1.html-ff0de9ef.js" as="script"><link rel="prefetch" href="/assets/2.html-df298bc8.js" as="script"><link rel="prefetch" href="/assets/4.html-b79841e4.js" as="script"><link rel="prefetch" href="/assets/5.html-3b791d09.js" as="script"><link rel="prefetch" href="/assets/index.html-19da1aef.js" as="script"><link rel="prefetch" href="/assets/index.html-1014656b.js" as="script"><link rel="prefetch" href="/assets/SSL-unsafe-legacy-renegotiation.html-1c0e5121.js" as="script"><link rel="prefetch" href="/assets/index.html-5e2b33ee.js" as="script"><link rel="prefetch" href="/assets/index.html-167b995b.js" as="script"><link rel="prefetch" href="/assets/index.html-d1644ada.js" as="script"><link rel="prefetch" href="/assets/404.html-92f93129.js" as="script"><link rel="prefetch" href="/assets/index.html-c925816b.js" as="script"><link rel="prefetch" href="/assets/index.html-9e0ed91e.js" as="script"><link rel="prefetch" href="/assets/index.html-d0fb99a3.js" as="script"><link rel="prefetch" href="/assets/index.html-c996c3aa.js" as="script"><link rel="prefetch" href="/assets/index.html-c5e1f44a.js" as="script"><link rel="prefetch" href="/assets/index.html-b1e37ac8.js" as="script"><link rel="prefetch" href="/assets/index.html-23fabdb8.js" as="script"><link rel="prefetch" href="/assets/index.html-526ef8b2.js" as="script"><link rel="prefetch" href="/assets/index.html-2afb6888.js" as="script"><link rel="prefetch" href="/assets/index.html-f6222bd1.js" as="script"><link rel="prefetch" href="/assets/index.html-c5d0f4ec.js" as="script"><link rel="prefetch" href="/assets/index.html-a9ef73a3.js" as="script"><link rel="prefetch" href="/assets/index.html-e4d6ae81.js" as="script"><link rel="prefetch" href="/assets/index.html-d1d6f74d.js" as="script"><link rel="prefetch" href="/assets/index.html-c8b6ded4.js" as="script"><link rel="prefetch" href="/assets/index.html-2dbf78a5.js" as="script"><link rel="prefetch" href="/assets/index.html-2ea563e3.js" as="script"><link rel="prefetch" href="/assets/index.html-d6454117.js" as="script"><link rel="prefetch" href="/assets/giscus-9b97f17f.js" as="script"><link rel="prefetch" href="/assets/auto-ba5ecab5.js" as="script"><link rel="prefetch" href="/assets/index-8764208e.js" as="script"><link rel="prefetch" href="/assets/flowchart-35969cab.js" as="script"><link rel="prefetch" href="/assets/mermaid.esm.min-0afa636d.js" as="script"><link rel="prefetch" href="/assets/highlight.esm-a794bb63.js" as="script"><link rel="prefetch" href="/assets/markdown.esm-d92a2fc9.js" as="script"><link rel="prefetch" href="/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/assets/notes.esm-224f94d9.js" as="script"><link rel="prefetch" href="/assets/reveal.esm-e5069ce0.js" as="script"><link rel="prefetch" href="/assets/search.esm-2c3fba7d.js" as="script"><link rel="prefetch" href="/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/assets/VuePlayground-4f15ffdb.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-6e6cbe40.js" as="script"><link rel="prefetch" href="/assets/SearchResult-a27c3425.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">본문으로 건너뛰기</a><!--]--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.svg" alt="비수의 개발 창고"><!----><span class="site-name hide-in-pad">비수의 개발 창고</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="비수의 개발 창고"><span class="font-icon icon fa-fw fa-sm fas fa-house" style=""></span>비수의 개발 창고<!----></a></div><div class="nav-item hide-in-mobile"><a href="/intro.html" class="nav-link" aria-label="프로필"><span class="font-icon icon fa-fw fa-sm fas fa-user" style=""></span>프로필<!----></a></div><div class="nav-item hide-in-mobile"><a href="/category/" class="nav-link" aria-label="카테고리"><span class="font-icon icon fa-fw fa-sm fas fa-table" style=""></span>카테고리<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="프로젝트"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-layer-group" style=""></span>프로젝트</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/projects/laravel-wrapper" class="nav-link" aria-label="LaravelWrapper"><span class="font-icon icon fa-fw fa-sm fas fa-layer-group" style=""></span>LaravelWrapper<!----></a></li><li class="dropdown-item"><a href="/projects/epalimi" class="nav-link" aria-label="은평알리미"><span class="font-icon icon fa-fw fa-sm fas fa-layer-group" style=""></span>은평알리미<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/posts/" class="nav-link active" aria-label="게시글"><span class="font-icon icon fa-fw fa-sm fas fa-list-ul" style=""></span>게시글<!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/Bisue/bisue.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><!----><!--[--><button class="search-pro-button" role="search" aria-label="검색"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="placeholder">검색</div><div class="key-hints"><kbd class="key">Ctrl</kbd><kbd class="key">F</kbd></div></button><!--]--><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><!--[--><div class="blogger-info" vocab="https://schema.org/" typeof="Person"><div class="blogger" style="cursor:pointer;" aria-label="프로필" data-balloon-pos="down" role="navigation"><img class="blogger-avatar round" src="https://avatars.githubusercontent.com/u/40070436?v=4" property="image" alt="Blogger Avatar"><div class="blogger-name" property="name">변찬혁</div><div class="blogger-description">Fullstack Web Developer</div><meta property="url" content="/intro.html"></div><div class="num-wrapper"><div><div class="num">7</div><div>게시글</div></div><div><div class="num">3</div><div>카테고리</div></div><div><div class="num">10</div><div>태그</div></div><div><div class="num">7</div><div>타임라인</div></div></div><div class="social-media-wrapper"><a class="social-media" href="https://github.com/Bisue" rel="noopener noreferrer" target="_blank" aria-label="GitHub" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024"><circle cx="512" cy="512" r="512" fill="#171515"/><path fill="#fff" d="M509.423 146.442c-200.317 0-362.756 162.42-362.756 362.8 0 160.266 103.936 296.24 248.109 344.217 18.139 3.327 24.76-7.872 24.76-17.486 0-8.613-.313-31.427-.49-61.702-100.912 21.923-122.205-48.63-122.205-48.63-16.495-41.91-40.28-53.067-40.28-53.067-32.937-22.51 2.492-22.053 2.492-22.053 36.407 2.566 55.568 37.386 55.568 37.386 32.362 55.438 84.907 39.43 105.58 30.143 3.296-23.444 12.667-39.43 23.032-48.498-80.557-9.156-165.246-40.28-165.246-179.297 0-39.604 14.135-71.988 37.342-97.348-3.731-9.178-16.18-46.063 3.556-96.009 0 0 30.46-9.754 99.76 37.19 28.937-8.048 59.97-12.071 90.823-12.211 30.807.14 61.843 4.165 90.822 12.21 69.26-46.944 99.663-37.189 99.663-37.189 19.792 49.946 7.34 86.831 3.61 96.01 23.25 25.359 37.29 57.742 37.29 97.347 0 139.366-84.82 170.033-165.637 179.013 13.026 11.2 24.628 33.342 24.628 67.182 0 48.498-.445 87.627-.445 99.521 0 9.702 6.535 20.988 24.945 17.444 144.03-48.067 247.881-183.95 247.881-344.175 0-200.378-162.442-362.798-362.802-362.798z"/></svg></a></div></div><!--]--><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="font-icon icon fa-fw fa-sm fas fa-pen" style=""></span>Pusher 를 이용한 실시간 채팅 웹앱 만들기 #3 (w/ Laravel, Nuxt)</h1><div class="page-info"><span class="page-author-info" aria-label="작성자🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/Bisue" target="_blank" rel="noopener noreferrer">변찬혁</a></span><span property="author" content="변찬혁"></span></span><!----><span class="page-date-info" aria-label="작성일📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2021-07-12T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="읽는 시간⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>약 1 분</span><meta property="timeRequired" content="PT1M"></span><span class="page-category-info" aria-label="카테고리🌈" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><span class="page-category-item category5 clickable" role="navigation">실시간 채팅 앱 만들기 (Pusher)</span><meta property="articleSection" content="실시간 채팅 앱 만들기 (Pusher)"></span><span class="page-tag-info" aria-label="태그🏷" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><span class="page-tag-item tag4 clickable" role="navigation">Pusher</span><span class="page-tag-item tag0 clickable" role="navigation">Laravel</span><span class="page-tag-item tag0 clickable" role="navigation">Nuxt</span><span class="page-tag-item tag2 clickable" role="navigation">Vue</span><span class="page-tag-item tag1 clickable" role="navigation">Web</span><meta property="keywords" content="Pusher,Laravel,Nuxt,Vue,Web"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">이 페이지에서<button class="print-button" title="print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/posts/pusher-chat-app/3.html#가장-기본적인-기능-구현하기" class="router-link-active router-link-exact-active toc-link level2">가장 기본적인 기능 구현하기</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/posts/pusher-chat-app/3.html#컨트롤러-생성" class="router-link-active router-link-exact-active toc-link level3">컨트롤러 생성</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/posts/pusher-chat-app/3.html#라우팅-정의" class="router-link-active router-link-exact-active toc-link level3">라우팅 정의</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/posts/pusher-chat-app/3.html#이벤트-작성" class="router-link-active router-link-exact-active toc-link level3">이벤트 작성</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/posts/pusher-chat-app/3.html#chatcontroller의-send-메서드-작성" class="router-link-active router-link-exact-active toc-link level3">ChatController의 send 메서드 작성</a></li><!----><!--]--></ul><!--]--></ul></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h1 id="pusher-를-이용한-실시간-채팅-웹앱-만들기-3-w-laravel-nuxt" tabindex="-1"><a class="header-anchor" href="#pusher-를-이용한-실시간-채팅-웹앱-만들기-3-w-laravel-nuxt" aria-hidden="true">#</a> Pusher 를 이용한 실시간 채팅 웹앱 만들기 #3 (w/ Laravel, Nuxt)</h1><p>이번 글에서는 본격적으로 채팅 서비스를 위한 백엔드 코드들을 <code>Laravel</code>로 작성해보면서 <code>Laravel</code>에서 <code>Pusher</code>와 연동하여 이벤트를 클라이언트들로 브로드캐스팅 해보겠습니다.</p><h2 id="가장-기본적인-기능-구현하기" tabindex="-1"><a class="header-anchor" href="#가장-기본적인-기능-구현하기" aria-hidden="true">#</a> 가장 기본적인 기능 구현하기</h2><h3 id="컨트롤러-생성" tabindex="-1"><a class="header-anchor" href="#컨트롤러-생성" aria-hidden="true">#</a> 컨트롤러 생성</h3><p>일단 먼저 어떤 사용자가 다른 사용자에게 보낼 메세지를 작성하고, 엔터를 누르거나 &#39;보내기&#39; 버튼을 누르면 그 메세지가 우리의 서버를 거쳐서 채팅에 참여하는 다른 사용자들에게 보내져야 할 것입니다.</p><p>그러기 위해서는 먼저 우리 서버에서 이렇게 사용자가 보낼 메세지를 담은 요청을 처리할 무언가가 필요합니다. 그 무언가를 우리는 <code>ChatController</code> 라고 이름 붙이고 이것을 만들어나가겠습니다.</p><p>프로젝트 루트(artisan 파일이 있는 디렉토리)에서 아래 <code>artisan</code> 명령을 사용하면 가장 기본적인 <code>Laravel</code> 컨트롤러의 뼈대를 가진 <code>app/Http/Controllers/ChatController.php</code> 가 생성됩니다. 직접 파일을 만들어도 되지만 <code>artisan</code> 명령을 사용하면 편리하게 만들 수 있습니다.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>php artisan make:controller ChatController
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>만들어진 파일은 가장 기본적인 컨트롤러의 형태입니다. 여기에 사용자가 메세지를 보내려고 할 때의 요청을 처리할 <code>send</code> 메서드를 추가합니다. 내용은 아직 구현하지 않습니다.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Request</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">ChatController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Todo..</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="라우팅-정의" tabindex="-1"><a class="header-anchor" href="#라우팅-정의" aria-hidden="true">#</a> 라우팅 정의</h3><p>지금 만든 컨트롤러는 &#39;어떤 요청을 누가 처리할 건가?&#39; 에서 &#39;누가&#39; 부분입니다. 어떤 컨트롤러의 메서드들이 어떤 요청을 담당해서 처리할 건지 분기하는 부분에 대한 정의가 필요합니다.</p><p>이 부분을 &#39;라우팅&#39; 이라고 하며 라우팅에 대한 정의는 <code>routes/</code> 디렉토리에 있는 파일들에 들어있습니다.</p><div class="hint-container info"><p class="hint-container-title">정보</p><p>기본 설정에서, <code>routes/api.php</code>의 라우트들과 <code>routes/web.php</code>의 라우트들은 서로 다른 속성(미들웨어, 접두사, 등등)을 갖습니다. 각각 어떤 속성들이 부여되는지는 <code>app/Providers/RouteServiceProvider.php</code>의 <code>boot</code> 메서드에서 확인할 수 있습니다. 자세한 내용은 <a href="https://laravel.kr/docs/8.x/routing" target="_blank" rel="noopener noreferrer">공식문서 참고<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p></div><div class="hint-container info"><p class="hint-container-title">정보</p><p>이 시리즈에서는 <code>Laravel</code>을 API 서버로 사용할 것이므로 쓸모없는 미들웨어는 제외하고 API에 필요한 미들웨어들만 모아서 이미 정의되어 있는 <code>api</code> 미들웨어 그룹을 사용하는 <code>routes/api.php</code>에서만 라우트들을 정의하겠습니다.</p></div><p>우리가 만든 <code>ChatController</code>의 <code>send</code> 메서드는 <code>[POST] /chat/send</code> 로 들어오는 요청을 처리하도록 라우트를 정의하겠습니다.</p><p>그 전에, 기본적으로 <code>routes/api.php</code>의 라우트들은 모두 <code>/api</code>라는 prefix를 갖도록 설정되어있는데, 우리는 <code>routes/web.php</code>를 사용하지 않을 것이므로 거추장스러운 접두사를 빼겠습니다.</p><p><code>app/Providers/RouteServiceProvider.php</code>의 <code>boot</code> 메서드로 가서 접두사를 붙이는 부분을 수정합니다. 메서드 체인에서 <code>prefix(&#39;api&#39;)</code> 메서드 호출 부분을 수정하면 됩니다.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">boot</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">configureRateLimiting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Route::prefix(&#39;api&#39;)</span>
        <span class="token comment">//     -&gt;middleware(&#39;api&#39;)</span>
        <span class="token comment">//     -&gt;namespace($this-&gt;namespace)</span>
        <span class="token comment">//     -&gt;group(base_path(&#39;routes/api.php&#39;));</span>
        
        <span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">middleware</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;api&#39;</span><span class="token punctuation">)</span>
            <span class="token operator">-&gt;</span><span class="token function">namespace</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">namespace</span><span class="token punctuation">)</span>
            <span class="token operator">-&gt;</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token function">base_path</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;routes/api.php&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">middleware</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;web&#39;</span><span class="token punctuation">)</span>
            <span class="token operator">-&gt;</span><span class="token function">namespace</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">namespace</span><span class="token punctuation">)</span>
            <span class="token operator">-&gt;</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token function">base_path</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;routes/web.php&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>이제 routes/api.php에서 <code>[POST] /chat/send</code>에 대한 라우트를 작성하겠습니다.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>ChatController</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Route</span><span class="token punctuation">;</span>

<span class="token comment">/*
|--------------------------------------------------------------------------
| API Routes
|--------------------------------------------------------------------------
|
| Here is where you can register API routes for your application. These
| routes are loaded by the RouteServiceProvider within a group which
| is assigned the &quot;api&quot; middleware group. Enjoy building your API!
|
*/</span>

<span class="token comment">// Route::middleware(&#39;auth:api&#39;)-&gt;get(&#39;/user&#39;, function (Request $request) {</span>
<span class="token comment">//     return $request-&gt;user();</span>
<span class="token comment">// });</span>

<span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/chat/send&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token class-name static-context">ChatController</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;send&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>기존에 파일에 존재하던 쓸모없는 라우트는 지우고, <code>[POST] /chat/send</code> 요청을 <code>ChatController</code>의 <code>send</code> 메서드가 처리하게 하는 라우트를 하나 작성했습니다.</p><p>이제 남은 것은 <code>ChatController</code>의 <code>send</code> 메서드의 내용을 작성하는 부분입니다.</p><h3 id="이벤트-작성" tabindex="-1"><a class="header-anchor" href="#이벤트-작성" aria-hidden="true">#</a> 이벤트 작성</h3><p><code>send</code> 메서드를 작성하기 전에, <code>Laravel</code>의 브로드캐스팅 기능은 특정 이벤트가 발생했을 때, <code>Laravel Event</code> 객체 데이터를 브로드캐스팅 채널을 구독하는 클라이언트들에게 전달하며 해당 이벤트가 발생했다는 것을 알려주는 기능입니다.</p><p>따라서 브로드캐스팅을 하려면 먼저 <code>Event</code> 객체를 정의해야합니다. 아래 명령으로 <code>ChatSent</code>라는 <code>Event</code> 클래스 파일을 만들어 정의합니다. 만들어진 파일은 <code>app/Events</code> 디렉토리에 생성됩니다.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>php artisan make:event ChatSent
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>만들어진 파일의 모습은 다음과 같습니다.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Events</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Broadcasting<span class="token punctuation">\</span>Channel</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Broadcasting<span class="token punctuation">\</span>InteractsWithSockets</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Broadcasting<span class="token punctuation">\</span>PresenceChannel</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Broadcasting<span class="token punctuation">\</span>PrivateChannel</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Contracts<span class="token punctuation">\</span>Broadcasting<span class="token punctuation">\</span>ShouldBroadcast</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Events<span class="token punctuation">\</span>Dispatchable</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Queue<span class="token punctuation">\</span>SerializesModels</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">ChatSent</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">Dispatchable</span><span class="token punctuation">,</span> InteractsWithSockets<span class="token punctuation">,</span> SerializesModels<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * Create a new event instance.
     *
     * <span class="token keyword">@return</span> <span class="token class-name"><span class="token keyword">void</span></span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * Get the channels the event should broadcast on.
     *
     * <span class="token keyword">@return</span> <span class="token class-name"><span class="token punctuation">\</span>Illuminate<span class="token punctuation">\</span>Broadcasting<span class="token punctuation">\</span>Channel<span class="token punctuation">|</span><span class="token keyword">array</span></span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">broadcastOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PrivateChannel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;channel-name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>ChatSent</code> 객체는 사용자가 메세지를 적어 보내면, 그 보낸이와 보낸 메세지 데이터를 담아 클라이언트로 전달되어야 합니다.</p><p>그러므로 클래스 내부에 변수를 만들고, 객체를 생성할 때 생성자에서 데이터를 넣을 수 있게 합니다.</p><p>또, 이벤트를 브로드캐스트하려면 해당 이벤트가 <code>ShouldBroadcast</code> 인터페이스를 구현해야합니다. 기본적으로 상단에 <code>use</code> 구문으로 들어가 있으므로, 바로 상속만 시켜주면 됩니다.</p><p><code>broadcastOn</code> 메서드는 이 이벤트가 브로드캐스트될 때, 어떤 채널을 통해 브로드캐스팅 될지 선택해주는 부분입니다.</p><p>여기서 채널의 종류로 <code>Public</code>, <code>Private</code>, <code>Presence</code> 세 가지가 있는데, 크게 클라이언트에서 해당 채널을 구독할 때 인증 절차를 거치느냐, 안 거치느냐의 두 분류로 나눌 수 있습니다.</p><p>우리의 가장 처음의 채팅 앱은 어떤 로그인도 없이 익명으로 대화할 수 있는 채팅 앱을 만들 예정입니다. 따라서 <code>Public</code> 채널을 사용하겠습니다.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token comment">// ShouldBroadcast 인터페이스</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">ChatSent</span> <span class="token keyword">implements</span> <span class="token class-name">ShouldBroadcast</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">Dispatchable</span><span class="token punctuation">,</span> InteractsWithSockets<span class="token punctuation">,</span> SerializesModels<span class="token punctuation">;</span>

    <span class="token comment">// 데이터 변수 추가</span>
    <span class="token keyword">public</span> <span class="token variable">$sender</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$message</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$sentAt</span><span class="token punctuation">;</span>

    <span class="token comment">// 생성자에서 값을 받아 할당</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$sender</span><span class="token punctuation">,</span> <span class="token variable">$message</span><span class="token punctuation">,</span> <span class="token variable">$sentAt</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">sender</span> <span class="token operator">=</span> <span class="token variable">$sender</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">message</span> <span class="token operator">=</span> <span class="token variable">$message</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">sentAt</span> <span class="token operator">=</span> <span class="token variable">$sentAt</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Laravel에서 Public 채널은 그냥 Channel 클래스로 표현합니다.</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">broadcastOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Channel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;chat&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="chatcontroller의-send-메서드-작성" tabindex="-1"><a class="header-anchor" href="#chatcontroller의-send-메서드-작성" aria-hidden="true">#</a> <code>ChatController</code>의 <code>send</code> 메서드 작성</h3><p>이제 글의 가장 첫 부분에서 미뤄두었던 <code>ChatController</code>의 <code>send</code> 메서드를 작성하기 위한 모든 나머지 코드들을 작성했습니다. 이제 <code>ChatController</code>의 <code>send</code> 메서드만 마저 작성하면 됩니다.</p><p><code>send</code> 메서드가 해야할 일은 간단합니다.</p><p>클라이언트에서 메세지와 보내는 사람의 이름을 간단하게 문자열의 형태로 요청에 담아 보낼것입니다. <code>send</code> 메서드는 단순히 이 데이터를 가지고 <code>ChatSent</code> 이벤트 객체를 하나 생성해 클라이언트들에게 브로드캐스팅하면 됩니다.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$sender</span> <span class="token operator">=</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;sender&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$message</span> <span class="token operator">=</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;message&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">broadcast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ChatSent</span><span class="token punctuation">(</span><span class="token variable">$sender</span><span class="token punctuation">,</span> <span class="token variable">$message</span><span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><p>가장 간단한 형태의 채팅 앱을 위한 백엔드 코드 작성이 끝났습니다.</p><p>지금 코드로는 DB도 사용하지 않아 클라이언트에서 새로고침을 하거나 하면 기존 대화목록이 남아있지도 않고, 단순히 클라이언트에서 메세지를 담은 요청을 우리 서버에 보내면, <code>chat</code> 채널을 구독하는 클라이언트들에게 브로드캐스팅하는 기능만 담당할 수 있습니다.</p><p>다음 포스팅부터 간단한 채팅 페이지를 만들어보고, 이 간단한 기능이 잘 작동하는지 먼저 테스트해본 후에 로그인, DB 연동 등 여러 가지 기능을 추가해보면서 가장 간단한 형태부터 우리가 원하는 최종 형태까지 채팅 앱을 개선하겠습니다.</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/Bisue/bisue.github.io/edit/main/docs/posts/pusher-chat-app/3.md" rel="noopener noreferrer" target="_blank" aria-label="이 페이지 수정" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->이 페이지 수정<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">마지막 수정: </span><!----></div><div class="contributors"><span class="label">기여자: </span><!--[--><!--[--><span class="contributor" title="email: bdu00chch@gmail.com">Chanhyuk Byeon</span><!--]--><!--]--></div></div></footer><nav class="page-nav"><a href="/posts/pusher-chat-app/2.html" class="nav-link prev" aria-label="Pusher 를 이용한 실시간 채팅 웹앱 만들기 #2 (w/ Laravel, Nuxt)"><div class="hint"><span class="arrow start"></span>이전</div><div class="link"><span class="font-icon icon fa-fw fa-sm fas fa-pen" style=""></span>Pusher 를 이용한 실시간 채팅 웹앱 만들기 #2 (w/ Laravel, Nuxt)</div></a><a href="/posts/pusher-chat-app/4.html" class="nav-link next" aria-label="Pusher 를 이용한 실시간 채팅 웹앱 만들기 #4 (w/ Laravel, Nuxt)"><div class="hint">다음<span class="arrow end"></span></div><div class="link">Pusher 를 이용한 실시간 채팅 웹앱 만들기 #4 (w/ Laravel, Nuxt)<span class="font-icon icon fa-fw fa-sm fas fa-pen" style=""></span></div></a></nav><div class="giscus-wrapper input-top" id="comment" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><!----><div class="copyright">Copyright © 2023 변찬혁</div></footer></div><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-62184bd0.js" defer></script>
  </body>
</html>
