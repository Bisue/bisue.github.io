import{a as O,b as P,n as V,c as W,d as _,e as z,m as I,l as J,f as K,y as N,h as T,g as X,i as Y,r as L,j as Z,k as ee,L as ae,H as se}from"./app-975506ff.js";import{c as le,B as te,H as re,r as m,h as w,o as ue,v as ne,j as e,R as E,w as oe,E as ce,i as ve}from"./framework-54cb4b8e.js";const ie="search-pro-result-history",o=O(ie,[]),pe=()=>{const{resultHistoryCount:r}=L,c=r>0;return{enabled:c,resultHistory:o,addResultHistory:l=>{c&&(o.value.length<r?o.value=[l,...o.value]:o.value=[l,...o.value.slice(0,r-1)])},removeResultHistory:l=>{o.value=[...o.value.slice(0,l),...o.value.slice(l+1)]}}},he=r=>{const c=P(),l=m(!1),h=m([]);let v;const i=Y(d=>{l.value=!0,v==null||v.terminate(),d?(v=new Worker(`/${L.worker}`,{}),v.addEventListener("message",({data:f})=>{h.value=f,l.value=!1}),v.postMessage({query:d,routeLocale:c.value})):(h.value=[],l.value=!1)},L.delay);return oe([r,c],()=>i(r.value),{immediate:!0}),{searching:l,results:h}};var me=le({name:"SearchResult",props:{query:{type:String,required:!0}},emits:["close","updateQuery"],setup(r,{emit:c}){const l=Z(),h=te(),v=P(),i=V(ee),{addQueryHistory:d}=ae(),{enabled:f,resultHistory:b,addResultHistory:S,removeResultHistory:Q}=pe(),R=re(r,"query"),{results:y,searching:j}=he(R),u=m(0),t=m(0),q=m(),C=w(()=>b.value.length>0),k=w(()=>y.value.length>0),H=w(()=>y.value[u.value]||null),x=()=>{u.value=u.value>0?u.value-1:y.value.length-1,t.value=H.value.contents.length-1},M=()=>{u.value=u.value<y.value.length-1?u.value+1:0,t.value=0},U=()=>{t.value<H.value.contents.length-1?t.value=t.value+1:M()},F=()=>{t.value>0?t.value=t.value-1:x()},D=a=>a.map(s=>ve(s)?s:e(s[0],s[1])),B=a=>{if(a.type==="custom"){const s=se[a.index]||"$content",[p,g=""]=ce(s)?s[v.value].split("$content"):s.split("$content");return D([p,...a.display,g])}return D(a.display)},$=()=>{u.value=0,t.value=0,c("updateQuery",""),c("close")};return ue(()=>{W("keydown",a=>{if(k.value){if(a.key==="ArrowUp")F();else if(a.key==="ArrowDown")U();else if(a.key==="Enter"){const s=H.value.contents[t.value];l.value.path!==s.path&&(d(r.query),S(s),h.push(s.path),$())}}}),_(q.value,{reserveScrollBarGap:!0})}),ne(()=>{z()}),()=>e("div",{class:["search-pro-result",{empty:R.value?!k.value:!C.value}],id:"search-pro-results",ref:q},R.value===""?C.value?e("ul",{class:"search-pro-result-list"},e("li",{class:"search-pro-result-list-item"},[e("div",{class:"search-pro-result-title"},i.value.history),b.value.map((a,s)=>e(E,{to:a.path,class:["search-pro-result-item",{active:t.value===s}],onClick:()=>{$()}},()=>[e(I,{class:"search-pro-result-type"}),e("div",{class:"search-pro-result-content"},[a.type==="content"&&a.header?e("div",{class:"content-header"},a.header):null,e("div",B(a))]),e("button",{class:"search-pro-close-icon",onClick:p=>{p.preventDefault(),p.stopPropagation(),Q(s)}},e(J))]))])):f?i.value.emptyHistory:i.value.emptyResult:j.value?e(K,{hint:i.value.searching}):k.value?e("ul",{class:"search-pro-result-list"},y.value.map(({title:a,contents:s},p)=>{const g=u.value===p;return e("li",{class:["search-pro-result-list-item",{active:g}]},[e("div",{class:"search-pro-result-title"},a||"Documentation"),s.map((n,G)=>{const A=g&&t.value===G;return e(E,{to:n.path,class:["search-pro-result-item",{active:A,"aria-selected":A}],onClick:()=>{d(r.query),S(n),$()}},()=>[n.type==="content"?null:e(n.type==="title"?N:n.type==="heading"?T:X,{class:"search-pro-result-type"}),e("div",{class:"search-pro-result-content"},[n.type==="content"&&n.header?e("div",{class:"content-header"},n.header):null,e("div",B(n))])])})])})):i.value.emptyResult)}});export{me as default};
